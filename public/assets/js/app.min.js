function gcd(t,e){return 0==e?t:gcd(e,t%e)}function parseUri(t){for(var e=parseUri.options,o=e.parser[e.strictMode?"strict":"loose"].exec(t),n={},i=14;i--;)n[e.key[i]]=o[i]||"";return n[e.q.name]={},n[e.key[12]].replace(e.q.parser,function(t,o,i){o&&(n[e.q.name][o]=i)}),n}var guid=function(){var t=function(){return Math.floor(65536*Math.random()).toString(16)};return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()};String.prototype.trunc=String.prototype.trunc||function(t){return this.length>t?this.substr(0,t-1)+"&hellip;":this},Array.indexOf||(Array.prototype.indexOf=function(t){for(var e=0;e<this.length;e++)if(this[e]==t)return e;return-1}),Array.prototype.contains=function(t){for(i in this)if(this[i]==t)return!0;return!1},Array.prototype.clean=function(t){for(var e=0;e<this.length;e++)this[e]==t&&(this.splice(e,1),e--);return this},RegExp.escape=function(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},String.prototype.isJSON=function(){try{JSON.parse(this)}catch(t){return!1}return!0},String.prototype.getExt=function(){var t=/(?:\.([^.]+))?$/;return t.exec(this)[1]},String.prototype.slugify=function(){var t=this.replace(/[^-a-zA-Z0-9\s_]+/gi,"");return t=t.replace(/-/gi,"_"),t=t.replace(/\s/gi,"-")},"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),String.prototype.capitalize=function(){return this.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})},getSize=function(t){var e=[];for(var o in t)e.push(o);return e.length},jQuery.fn.style=function(t,e,o){var n=this.get(0);if("undefined"!=typeof n){var i=this.get(0).style;if("undefined"==typeof t)return i;if("undefined"==typeof e)return i.getPropertyValue(t);var o="undefined"!=typeof o?o:"";i.setProperty(t,e,o)}};var MD5=function(t){function e(t,e){return t<<e|t>>>32-e}function o(t,e){var o,n,i,r,a;return i=2147483648&t,r=2147483648&e,o=1073741824&t,n=1073741824&e,a=(1073741823&t)+(1073741823&e),o&n?2147483648^a^i^r:o|n?1073741824&a?3221225472^a^i^r:1073741824^a^i^r:a^i^r}function n(t,e,o){return t&e|~t&o}function i(t,e,o){return t&o|e&~o}function r(t,e,o){return t^e^o}function a(t,e,o){return e^(t|~o)}function s(t,i,r,a,s,l,c){return t=o(t,o(o(n(i,r,a),s),c)),o(e(t,l),i)}function l(t,n,r,a,s,l,c){return t=o(t,o(o(i(n,r,a),s),c)),o(e(t,l),n)}function c(t,n,i,a,s,l,c){return t=o(t,o(o(r(n,i,a),s),c)),o(e(t,l),n)}function d(t,n,i,r,s,l,c){return t=o(t,o(o(a(n,i,r),s),c)),o(e(t,l),n)}function p(t){for(var e,o=t.length,n=o+8,i=(n-n%64)/64,r=16*(i+1),a=Array(r-1),s=0,l=0;o>l;)e=(l-l%4)/4,s=l%4*8,a[e]=a[e]|t.charCodeAt(l)<<s,l++;return e=(l-l%4)/4,s=l%4*8,a[e]=a[e]|128<<s,a[r-2]=o<<3,a[r-1]=o>>>29,a}function u(t){var e,o,n="",i="";for(o=0;3>=o;o++)e=t>>>8*o&255,i="0"+e.toString(16),n+=i.substr(i.length-2,2);return n}function h(t){t=t.replace(/\r\n/g,"\n");for(var e="",o=0;o<t.length;o++){var n=t.charCodeAt(o);128>n?e+=String.fromCharCode(n):n>127&&2048>n?(e+=String.fromCharCode(n>>6|192),e+=String.fromCharCode(63&n|128)):(e+=String.fromCharCode(n>>12|224),e+=String.fromCharCode(n>>6&63|128),e+=String.fromCharCode(63&n|128))}return e}var f,g,m,v,y,k,b,w,C,T=Array(),_=7,$=12,x=17,L=22,S=5,A=9,D=14,N=20,B=4,I=11,M=16,E=23,O=6,W=10,H=15,R=21;for(t=h(t),T=p(t),k=1732584193,b=4023233417,w=2562383102,C=271733878,f=0;f<T.length;f+=16)g=k,m=b,v=w,y=C,k=s(k,b,w,C,T[f+0],_,3614090360),C=s(C,k,b,w,T[f+1],$,3905402710),w=s(w,C,k,b,T[f+2],x,606105819),b=s(b,w,C,k,T[f+3],L,3250441966),k=s(k,b,w,C,T[f+4],_,4118548399),C=s(C,k,b,w,T[f+5],$,1200080426),w=s(w,C,k,b,T[f+6],x,2821735955),b=s(b,w,C,k,T[f+7],L,4249261313),k=s(k,b,w,C,T[f+8],_,1770035416),C=s(C,k,b,w,T[f+9],$,2336552879),w=s(w,C,k,b,T[f+10],x,4294925233),b=s(b,w,C,k,T[f+11],L,2304563134),k=s(k,b,w,C,T[f+12],_,1804603682),C=s(C,k,b,w,T[f+13],$,4254626195),w=s(w,C,k,b,T[f+14],x,2792965006),b=s(b,w,C,k,T[f+15],L,1236535329),k=l(k,b,w,C,T[f+1],S,4129170786),C=l(C,k,b,w,T[f+6],A,3225465664),w=l(w,C,k,b,T[f+11],D,643717713),b=l(b,w,C,k,T[f+0],N,3921069994),k=l(k,b,w,C,T[f+5],S,3593408605),C=l(C,k,b,w,T[f+10],A,38016083),w=l(w,C,k,b,T[f+15],D,3634488961),b=l(b,w,C,k,T[f+4],N,3889429448),k=l(k,b,w,C,T[f+9],S,568446438),C=l(C,k,b,w,T[f+14],A,3275163606),w=l(w,C,k,b,T[f+3],D,4107603335),b=l(b,w,C,k,T[f+8],N,1163531501),k=l(k,b,w,C,T[f+13],S,2850285829),C=l(C,k,b,w,T[f+2],A,4243563512),w=l(w,C,k,b,T[f+7],D,1735328473),b=l(b,w,C,k,T[f+12],N,2368359562),k=c(k,b,w,C,T[f+5],B,4294588738),C=c(C,k,b,w,T[f+8],I,2272392833),w=c(w,C,k,b,T[f+11],M,1839030562),b=c(b,w,C,k,T[f+14],E,4259657740),k=c(k,b,w,C,T[f+1],B,2763975236),C=c(C,k,b,w,T[f+4],I,1272893353),w=c(w,C,k,b,T[f+7],M,4139469664),b=c(b,w,C,k,T[f+10],E,3200236656),k=c(k,b,w,C,T[f+13],B,681279174),C=c(C,k,b,w,T[f+0],I,3936430074),w=c(w,C,k,b,T[f+3],M,3572445317),b=c(b,w,C,k,T[f+6],E,76029189),k=c(k,b,w,C,T[f+9],B,3654602809),C=c(C,k,b,w,T[f+12],I,3873151461),w=c(w,C,k,b,T[f+15],M,530742520),b=c(b,w,C,k,T[f+2],E,3299628645),k=d(k,b,w,C,T[f+0],O,4096336452),C=d(C,k,b,w,T[f+7],W,1126891415),w=d(w,C,k,b,T[f+14],H,2878612391),b=d(b,w,C,k,T[f+5],R,4237533241),k=d(k,b,w,C,T[f+12],O,1700485571),C=d(C,k,b,w,T[f+3],W,2399980690),w=d(w,C,k,b,T[f+10],H,4293915773),b=d(b,w,C,k,T[f+1],R,2240044497),k=d(k,b,w,C,T[f+8],O,1873313359),C=d(C,k,b,w,T[f+15],W,4264355552),w=d(w,C,k,b,T[f+6],H,2734768916),b=d(b,w,C,k,T[f+13],R,1309151649),k=d(k,b,w,C,T[f+4],O,4149444226),C=d(C,k,b,w,T[f+11],W,3174756917),w=d(w,C,k,b,T[f+2],H,718787259),b=d(b,w,C,k,T[f+9],R,3951481745),k=o(k,g),b=o(b,m),w=o(w,v),C=o(C,y);var j=u(k)+u(b)+u(w)+u(C);return j.toLowerCase()};jQuery.fn.sortElements=function(){var t=[].sort;return function(e,o){o=o||function(){return this};var n=this.map(function(){var t=o.call(this),e=t.parentNode,n=e.insertBefore(document.createTextNode(""),t.nextSibling);return function(){if(e===this)throw new Error("You can't sort elements if any one is a descendant of another.");e.insertBefore(this,n),e.removeChild(n)}});return t.call(this,e).each(function(t){n[t].call(o.call(this))})}}(),function(t){t.extend(t.expr[":"],{parents:function(t,e,o){return jQuery(t).parents(o[3]).length>0},icontains:function(t,e,o,n){return(t.textContent||t.innerText||jQuery(t).text()||"").toLowerCase().indexOf(o[3].toLowerCase())>=0},tagname:function(e,o,n){var i=new RegExp(String(n[3]).replace(/^\s+|\s+$/g,""),"ig");return i.test(String(t(e)[0].tagName))},regex:function(e,o,n){var i=n[3].split(","),r=/^(data|css):/,a={method:i[0].match(r)?i[0].split(":")[0]:"attr",property:i.shift().replace(r,"")},s="ig",l=new RegExp(i.join("").replace(/^\s+|\s+$/g,""),s);return l.test(t(e)[a.method](a.property))}})}(jQuery),parseUri.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},function(){var t={};this.tmpl=function e(o,n){var i=/\W/.test(o)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+o.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):t[o]=t[o]||e(document.getElementById(o).innerHTML);return n?i(n):i}}(),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){function e(e,n){var i,r,a,s=e.nodeName.toLowerCase();return"area"===s?(i=e.parentNode,r=i.name,e.href&&r&&"map"===i.nodeName.toLowerCase()?(a=t("img[usemap='#"+r+"']")[0],!!a&&o(a)):!1):(/^(input|select|textarea|button|object)$/.test(s)?!e.disabled:"a"===s?e.href||n:n)&&o(e)}function o(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter(function(){return"hidden"===t.css(this,"visibility")}).length}t.ui=t.ui||{},t.extend(t.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({scrollParent:function(e){var o=this.css("position"),n="absolute"===o,i=e?/(auto|scroll|hidden)/:/(auto|scroll)/,r=this.parents().filter(function(){var e=t(this);return n&&"static"===e.css("position")?!1:i.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return"fixed"!==o&&r.length?r:t(this[0].ownerDocument||document)},uniqueId:function(){var t=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++t)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&t(this).removeAttr("id")})}}),t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(o){return!!t.data(o,e)}}):function(e,o,n){return!!t.data(e,n[3])},focusable:function(o){return e(o,!isNaN(t.attr(o,"tabindex")))},tabbable:function(o){var n=t.attr(o,"tabindex"),i=isNaN(n);return(i||n>=0)&&e(o,!i)}}),t("<a>").outerWidth(1).jquery||t.each(["Width","Height"],function(e,o){function n(e,o,n,r){return t.each(i,function(){o-=parseFloat(t.css(e,"padding"+this))||0,n&&(o-=parseFloat(t.css(e,"border"+this+"Width"))||0),r&&(o-=parseFloat(t.css(e,"margin"+this))||0)}),o}var i="Width"===o?["Left","Right"]:["Top","Bottom"],r=o.toLowerCase(),a={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+o]=function(e){return void 0===e?a["inner"+o].call(this):this.each(function(){t(this).css(r,n(this,e)+"px")})},t.fn["outer"+o]=function(e,i){return"number"!=typeof e?a["outer"+o].call(this,e):this.each(function(){t(this).css(r,n(this,e,!0,i)+"px")})}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(t.fn.removeData=function(e){return function(o){return arguments.length?e.call(this,t.camelCase(o)):e.call(this)}}(t.fn.removeData)),t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),t.fn.extend({focus:function(e){return function(o,n){return"number"==typeof o?this.each(function(){var e=this;setTimeout(function(){t(e).focus(),n&&n.call(e)},o)}):e.apply(this,arguments)}}(t.fn.focus),disableSelection:function(){var t="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(t+".ui-disableSelection",function(t){t.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(e){if(void 0!==e)return this.css("zIndex",e);if(this.length)for(var o,n,i=t(this[0]);i.length&&i[0]!==document;){if(o=i.css("position"),("absolute"===o||"relative"===o||"fixed"===o)&&(n=parseInt(i.css("zIndex"),10),!isNaN(n)&&0!==n))return n;i=i.parent()}return 0}}),t.ui.plugin={add:function(e,o,n){var i,r=t.ui[e].prototype;for(i in n)r.plugins[i]=r.plugins[i]||[],r.plugins[i].push([o,n[i]])},call:function(t,e,o,n){var i,r=t.plugins[e];if(r&&(n||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(i=0;i<r.length;i++)t.options[r[i][0]]&&r[i][1].apply(t.element,o)}},function(){function e(t,e,o){return[parseFloat(t[0])*(h.test(t[0])?e/100:1),parseFloat(t[1])*(h.test(t[1])?o/100:1)]}function o(e,o){return parseInt(t.css(e,o),10)||0}function n(e){var o=e[0];return 9===o.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:t.isWindow(o)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:o.preventDefault?{width:0,height:0,offset:{top:o.pageY,left:o.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}t.ui=t.ui||{};var i,r,a=Math.max,s=Math.abs,l=Math.round,c=/left|center|right/,d=/top|center|bottom/,p=/[\+\-]\d+(\.[\d]+)?%?/,u=/^\w+/,h=/%$/,f=t.fn.position;t.position={scrollbarWidth:function(){if(void 0!==i)return i;var e,o,n=t("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),r=n.children()[0];return t("body").append(n),e=r.offsetWidth,n.css("overflow","scroll"),o=r.offsetWidth,e===o&&(o=n[0].clientWidth),n.remove(),i=e-o},getScrollInfo:function(e){var o=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),n=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),i="scroll"===o||"auto"===o&&e.width<e.element[0].scrollWidth,r="scroll"===n||"auto"===n&&e.height<e.element[0].scrollHeight;return{width:r?t.position.scrollbarWidth():0,height:i?t.position.scrollbarWidth():0}},getWithinInfo:function(e){var o=t(e||window),n=t.isWindow(o[0]),i=!!o[0]&&9===o[0].nodeType;return{element:o,isWindow:n,isDocument:i,offset:o.offset()||{left:0,top:0},scrollLeft:o.scrollLeft(),scrollTop:o.scrollTop(),width:n||i?o.width():o.outerWidth(),height:n||i?o.height():o.outerHeight()}}},t.fn.position=function(i){if(!i||!i.of)return f.apply(this,arguments);i=t.extend({},i);var h,g,m,v,y,k,b=t(i.of),w=t.position.getWithinInfo(i.within),C=t.position.getScrollInfo(w),T=(i.collision||"flip").split(" "),_={};return k=n(b),b[0].preventDefault&&(i.at="left top"),g=k.width,m=k.height,v=k.offset,y=t.extend({},v),t.each(["my","at"],function(){var t,e,o=(i[this]||"").split(" ");1===o.length&&(o=c.test(o[0])?o.concat(["center"]):d.test(o[0])?["center"].concat(o):["center","center"]),o[0]=c.test(o[0])?o[0]:"center",o[1]=d.test(o[1])?o[1]:"center",t=p.exec(o[0]),e=p.exec(o[1]),_[this]=[t?t[0]:0,e?e[0]:0],i[this]=[u.exec(o[0])[0],u.exec(o[1])[0]]}),1===T.length&&(T[1]=T[0]),"right"===i.at[0]?y.left+=g:"center"===i.at[0]&&(y.left+=g/2),"bottom"===i.at[1]?y.top+=m:"center"===i.at[1]&&(y.top+=m/2),h=e(_.at,g,m),y.left+=h[0],y.top+=h[1],this.each(function(){var n,c,d=t(this),p=d.outerWidth(),u=d.outerHeight(),f=o(this,"marginLeft"),k=o(this,"marginTop"),$=p+f+o(this,"marginRight")+C.width,x=u+k+o(this,"marginBottom")+C.height,L=t.extend({},y),S=e(_.my,d.outerWidth(),d.outerHeight());"right"===i.my[0]?L.left-=p:"center"===i.my[0]&&(L.left-=p/2),"bottom"===i.my[1]?L.top-=u:"center"===i.my[1]&&(L.top-=u/2),L.left+=S[0],L.top+=S[1],r||(L.left=l(L.left),L.top=l(L.top)),n={marginLeft:f,marginTop:k},t.each(["left","top"],function(e,o){t.ui.position[T[e]]&&t.ui.position[T[e]][o](L,{targetWidth:g,targetHeight:m,elemWidth:p,elemHeight:u,collisionPosition:n,collisionWidth:$,collisionHeight:x,offset:[h[0]+S[0],h[1]+S[1]],my:i.my,at:i.at,within:w,elem:d})}),i.using&&(c=function(t){var e=v.left-L.left,o=e+g-p,n=v.top-L.top,r=n+m-u,l={target:{element:b,left:v.left,top:v.top,width:g,height:m},element:{element:d,left:L.left,top:L.top,width:p,height:u},horizontal:0>o?"left":e>0?"right":"center",vertical:0>r?"top":n>0?"bottom":"middle"};p>g&&s(e+o)<g&&(l.horizontal="center"),u>m&&s(n+r)<m&&(l.vertical="middle"),l.important=a(s(e),s(o))>a(s(n),s(r))?"horizontal":"vertical",i.using.call(this,t,l)}),d.offset(t.extend(L,{using:c}))})},t.ui.position={fit:{left:function(t,e){var o,n=e.within,i=n.isWindow?n.scrollLeft:n.offset.left,r=n.width,s=t.left-e.collisionPosition.marginLeft,l=i-s,c=s+e.collisionWidth-r-i;e.collisionWidth>r?l>0&&0>=c?(o=t.left+l+e.collisionWidth-r-i,t.left+=l-o):t.left=c>0&&0>=l?i:l>c?i+r-e.collisionWidth:i:l>0?t.left+=l:c>0?t.left-=c:t.left=a(t.left-s,t.left)},top:function(t,e){var o,n=e.within,i=n.isWindow?n.scrollTop:n.offset.top,r=e.within.height,s=t.top-e.collisionPosition.marginTop,l=i-s,c=s+e.collisionHeight-r-i;e.collisionHeight>r?l>0&&0>=c?(o=t.top+l+e.collisionHeight-r-i,t.top+=l-o):t.top=c>0&&0>=l?i:l>c?i+r-e.collisionHeight:i:l>0?t.top+=l:c>0?t.top-=c:t.top=a(t.top-s,t.top)}},flip:{left:function(t,e){var o,n,i=e.within,r=i.offset.left+i.scrollLeft,a=i.width,l=i.isWindow?i.scrollLeft:i.offset.left,c=t.left-e.collisionPosition.marginLeft,d=c-l,p=c+e.collisionWidth-a-l,u="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,h="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,f=-2*e.offset[0];0>d?(o=t.left+u+h+f+e.collisionWidth-a-r,(0>o||o<s(d))&&(t.left+=u+h+f)):p>0&&(n=t.left-e.collisionPosition.marginLeft+u+h+f-l,(n>0||s(n)<p)&&(t.left+=u+h+f))},top:function(t,e){var o,n,i=e.within,r=i.offset.top+i.scrollTop,a=i.height,l=i.isWindow?i.scrollTop:i.offset.top,c=t.top-e.collisionPosition.marginTop,d=c-l,p=c+e.collisionHeight-a-l,u="top"===e.my[1],h=u?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,f="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,g=-2*e.offset[1];0>d?(n=t.top+h+f+g+e.collisionHeight-a-r,(0>n||n<s(d))&&(t.top+=h+f+g)):p>0&&(o=t.top-e.collisionPosition.marginTop+h+f+g-l,(o>0||s(o)<p)&&(t.top+=h+f+g))}},flipfit:{left:function(){t.ui.position.flip.left.apply(this,arguments),t.ui.position.fit.left.apply(this,arguments)},top:function(){t.ui.position.flip.top.apply(this,arguments),t.ui.position.fit.top.apply(this,arguments)}}},function(){var e,o,n,i,a,s=document.getElementsByTagName("body")[0],l=document.createElement("div");e=document.createElement(s?"div":"body"),n={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},s&&t.extend(n,{position:"absolute",left:"-1000px",top:"-1000px"});for(a in n)e.style[a]=n[a];e.appendChild(l),o=s||document.documentElement,o.insertBefore(e,o.firstChild),l.style.cssText="position: absolute; left: 10.7432222px;",i=t(l).offset().left,r=i>10&&11>i,e.innerHTML="",o.removeChild(e)}()}();t.ui.position}),function(t,e){function o(o,n,r){o=t(o);var a=o.data("LoadingOverlayCount");if(a===e&&(a=0),0==a){var s=t("<div>",{"class":"loadingoverlay",css:{"background-color":n.color,"background-image":n.image?"url("+n.image+")":"none","background-position":"center center","background-repeat":"no-repeat"}});if(r)s.css({position:"fixed",top:0,left:0,width:"100%",height:"100%"});else if(s.css({position:"absolute",top:0,left:0}),i(o,s,n),"static"==o.css("position")&&s.css({top:o.position().top+parseInt(o.css("margin-top"))+parseInt(o.css("border-top-width")),left:o.position().left+parseInt(o.css("margin-left"))+parseInt(o.css("border-left-width"))}),n.resizeInterval>0){var l=setInterval(function(){i(o,s,n)},n.resizeInterval);o.data("LoadingOverlayResizeIntervalId",l)}s.appendTo(o)}a++,o.data("LoadingOverlayCount",a)}function n(o,n){o=t(o);var i=o.data("LoadingOverlayCount");if(i!==e)if(i--,n||0>=i){var r=o.data("LoadingOverlayResizeIntervalId");r&&clearInterval(r),o.removeData("LoadingOverlayCount").removeData("LoadingOverlayResizeIntervalId"),o.children(".loadingoverlay").remove()}else o.data("LoadingOverlayCount",i)}function i(e,o,n){var i="auto";if(n.size&&"auto"!=n.size){var i=Math.min(e.innerWidth(),e.innerHeight())*parseFloat(n.size)/100;n.maxSize&&i>parseInt(n.maxSize)&&(i=parseInt(n.maxSize)+"px"),n.minSize&&i<parseInt(n.minSize)&&(i=parseInt(n.minSize)+"px")}t(o).css({width:e.innerWidth(),height:e.innerHeight(),"background-size":i})}var r={color:"rgba(255, 255, 255, 0.8)",image:"/assets/images/loading.gif",maxSize:"100px",minSize:"20px",resizeInterval:0,size:"50%"};t.LoadingOverlaySetup=function(e){t.extend(!0,r,e)},t.LoadingOverlay=function(e,i){switch(e.toLowerCase()){case"show":var a=t.extend(!0,{},r,i);o("body",a,!0);break;case"hide":n("body",i)}},t.fn.LoadingOverlay=function(e,i){switch(e.toLowerCase()){case"show":var a=t.extend(!0,{},r,i);return this.each(function(){o(this,a,!1)});case"hide":return this.each(function(){n(this,i)})}}}(jQuery),window.App=window.App||{},window.App.GChart={dataCollection:[],init:function(){var t=this;t.getData()},drawGroupChart:function(t){var e=google.visualization.arrayToDataTable(t),o={chart:{title:"Graph",subtitle:"Incident Report: 2014-2017"},bars:"vertical",vAxis:{format:"decimal"},height:400,colors:["#1b9e77","#d95f02","#7570b3","red","blue"]},n=new google.charts.Bar(document.getElementById("column-group"));n.draw(e,google.charts.Bar.convertOptions(o))},drawBarChart:function(t){},drawDoughnutChart:function(t){var e=google.visualization.arrayToDataTable(t),o={title:"My Daily Activities",pieHole:.4},n=new google.visualization.PieChart(document.getElementById("doughnut"));n.draw(e,o)},getData:function(){var t=this;$.ajax({url:"/ticket/category/report"}).done(function(e){if("ok"===e.status){var o=e.googleChart.barGroup;t.drawGroupChart(o);var n=e.googleChart.doughnut;t.drawDoughnutChart(n)}})}},window.App=window.App||{},window.App.JSChart={chartOptions:{scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,bezierCurve:!1,bezierCurveTension:.4,pointDot:!0,pointDotRadius:4,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!0,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'},init:function(){var t=this;t.getTicketReport()},updateColor:function(t,e,o){myObjBar=_.isUndefined(o)?new Chart(t).Bar(e):new Chart(t).Bar(e,o),myObjBar.datasets[0].bars[0].fillColor="red",myObjBar.datasets[0].bars[1].fillColor="orange",myObjBar.datasets[0].bars[2].fillColor="yellow",myObjBar.datasets[0].bars[3].fillColor="blue",myObjBar.datasets[0].bars[4].fillColor="green",myObjBar.datasets[0].bars[0].highlightFill="lightred",myObjBar.datasets[0].bars[1].highlightFill="lightorange",myObjBar.datasets[0].bars[2].highlightFill="lightyellow",myObjBar.datasets[0].bars[3].highlightFill="lightblue",myObjBar.datasets[0].bars[4].highlightFill="lightgreen",myObjBar.update()},getTicketReport:function(){var t=this,e={allTickets:"/ticket/report",ticketsByCategory:"/ticket/category/report"};$.getJSON(e.ticketsByCategory,function(e){console.log(e);var o=e.chart.bar_line,n=e.chart.pie_dougnut;t.renderGraphBar(t.barContext(),o,t.chartOptions),t.updateColor(t.barContext(),o,t.chartOptions),t.renderGraphLine(t.lineContext(),o,t.chartOptions),t.renderGraphPie(t.pieContext(),n),t.renderGraphDoughnut(t.doughnutContext(),n)})},barLineGraph:function(){var t=this,e={labels:["May","June","July"],datasets:[{label:"1st data set",data:[200,180,290],fillColor:"rgba(220,220,220,0.5)",strokeColor:"rgba(220,220,220,0.8)",highlightFill:"rgba(220,220,220,0.75)",highlightStroke:"rgba(220,220,220,1)"},{label:"2nd data set",data:[120,80,300],fillColor:"rgba(151,187,205,0.5)",strokeColor:"rgba(151,187,205,0.8)",highlightFill:"rgba(151,187,205,0.75)",highlightStroke:"rgba(151,187,205,1)"},{label:"3rd data set",data:[220,280,350],fillColor:"rgba(100,187,205,0.5)",strokeColor:"rgba(100,187,205,0.8)",highlightFill:"rgba(100,187,205,0.75)",highlightStroke:"rgba(100,187,205,1)"}]};t.renderGraphBar(t.barContext(),e,t.chartOptions),t.renderGraphLine(t.lineContext(),e,t.chartOptions)},pieDoughnutGraph:function(){var t=this,e=[{value:300,color:"#F7464A",highlight:"#FF5A5E",label:"Red"},{value:50,color:"#46BFBD",highlight:"#5AD3D1",label:"Green"},{value:100,color:"#FDB45C",highlight:"#FFC870",label:"Yellow"}];t.renderGraphPie(t.pieContext(),e),t.renderGraphDoughnut(t.doughnutContext(),e)},barContext:function(){return $("#bar-chart").get(0).getContext("2d")},lineContext:function(){return $("#line-chart").get(0).getContext("2d")},pieContext:function(){return $("#pie-chart").get(0).getContext("2d")},doughnutContext:function(){return $("#doughnut-chart").get(0).getContext("2d")},renderGraphBar:function(t,e,o){_.isUndefined(o)?new Chart(t).Bar(e):new Chart(t).Bar(e,o)},renderGraphLine:function(t,e,o){_.isUndefined(o)?new Chart(t).Line(e):new Chart(t).Line(e,o)},renderGraphPie:function(t,e,o){_.isUndefined(o)?new Chart(t).Pie(e):new Chart(t).Pie(e,o)},renderGraphDoughnut:function(t,e,o){_.isUndefined(o)?new Chart(t).Doughnut(e):new Chart(t).Doughnut(e,o)}},window.App=window.App||{},window.App.Maps={$mapContainer:$("#map-container"),defaultZoomLevel:10,autoComplete:!1,region:"PH",map:!1,mapCenter:!1,markers:{},mapBounds:!1,userLocation:!1,currentLocation:!1,mapLoaded:!1,selectedLat:0,selectedLng:0,"default":{lat:13.9490476,lng:121.1579272,location:"Lipa Batangas, PH",zoomLevel:13},mapStyle:[{featureType:"all",elementType:"labels.text.fill",stylers:[{color:"#ffffff"}]},{featureType:"all",elementType:"labels.text.stroke",stylers:[{color:"#000000"},{lightness:13}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{color:"#000000"}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#144b53"},{lightness:14},{weight:1.4}]},{featureType:"administrative.locality",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"administrative.locality",elementType:"labels.icon",stylers:[{visibility:"on"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#08304b"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#0c4152"},{lightness:5}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#000000"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#0b434f"},{lightness:25}]},{featureType:"road.arterial",elementType:"geometry.fill",stylers:[{color:"#000000"}]},{featureType:"road.arterial",elementType:"geometry.stroke",stylers:[{color:"#0b3d51"},{lightness:16}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#000000"}]},{featureType:"transit",elementType:"labels.text.fill",stylers:[{color:"#ffffff"}]},{featureType:"water",elementType:"all",stylers:[{color:"#021019"}]}],init:function(){var t=this;t.loadMapScript()},loadMapScript:function(){var t=document.createElement("script");t.type="text/javascript",t.src="//maps.googleapis.com/maps/api/js?v=3.exp&language=en&sensor=false&libraries=places,geometry&callback=App.Maps.mapScriptLoaded",document.body.appendChild(t)},mapScriptLoaded:function(){var t=this;t.loadMap(t.$mapContainer,null,function(t){t.getInitLocation(),t.mapLoaded=!0})},eventHandler:function(){var t=this;google.maps.event.addListener(t.map,"click",function(e){t.selectedLat=e.latLng.lat(),t.selectedLng=e.latLng.lng(),console.log("map module..."),console.log(t.selectedLat),console.log(t.selectedLng),App.Ticket.saveSelectedLatLong(t.selectedLat,t.selectedLng)})},loadMap:function(t,e,o){var n=this;if(e=e||{},0===t.length)return!1;n["default"]=$.extend(n["default"],e),n.mapCenter=new google.maps.LatLng(n["default"].lat,n["default"].lng),n.currentLocation=n.mapCenter;var i={zoom:n["default"].zoomLevel,center:n.mapCenter,options:{styles:n.mapStyle},scrollwheel:!1,mapTypeControl:!1,panControl:!1,scaleControl:!0,zoomControl:!0,streetViewControl:!1,zoomControlOptions:{style:google.maps.ZoomControlStyle.LARGE,position:google.maps.ControlPosition.TOP_RIGHT}};t.ready(function(){n.map=new google.maps.Map(t[0],i),"function"==typeof o&&o(n)}),n.eventHandler()},getInitLocation:function(t,e){var o=this;e?(o.mapCenter=new google.maps.LatLng(t,e),o.currentLocation=o.mapCenter,o.userLocation=o.mapCenter,o.map.setZoom(o["default"].zoomLevel),o.map.setCenter(o.mapCenter),o.geolocationInProgress=!1,o.initDefaultGeoInterval=setInterval(function(){o.geolocationInProgress||clearInterval(o.initDefaultGeoInterval)},200)):navigator.geolocation&&(o.geolocationInProgress=!0,navigator.geolocation.getCurrentPosition(function(t){console.log(t),o.mapCenter=new google.maps.LatLng(t.coords.latitude,t.coords.longitude),o.currentLocation=o.mapCenter,o.userLocation=o.mapCenter,o.map.setZoom(o["default"].zoomLevel),o.map.setCenter(o.mapCenter),o.geolocationInProgress=!1},function(t){o.geolocationInProgress=!1},{maximumAge:6e5,timeout:1e4}),o.initDefaultGeoInterval=setInterval(function(){o.geolocationInProgress||clearInterval(o.initDefaultGeoInterval)},200))},addMarker:function(t,e,o){var n=this;if(0==t||0==e)return!1;if(n.mapLoaded){var i=new google.maps.LatLng(t,e),r=new google.maps.Marker({position:i,map:n.map,tag:"ticket-"+o});n.markers[String(o)]=r}else setTimeout(function(){n.addMarker(t,e,o)},100)},bounceMarker:function(t,e){var o=this;if("undefined"==typeof o.markers[t])return!1;"undefined"==typeof o.markers[t].isBounce&&(o.markers[t].isBounce=!e);var n=o.markers[t];return n.isBounce==e?!1:(o.markers[t].isBounce=e,void(e?(n.setAnimation(google.maps.Animation.BOUNCE),o.map.panTo(n.getPosition())):n.setAnimation(null)))},clearMarker:function(){var t=this;$.each(t.markers,function(t,e){e.setMap(null)}),t.markers=[],t.mapBounds=!1,t.currentStores=[]},getLongLat:function(t,e){return new google.maps.LatLng(t,e)},computeDistance:function(t,e){var o=google.maps.geometry.spherical.computeDistanceBetween(t,e);return o/1e3}},$(function(){App.Maps.init()}),window.App=window.App||{},window.App.TicketDetail={detailLastUpdate:0,selectedTicket:!1,modalVisible:!1,template:{ticket_detail:$("#ticket-detail-template").html(),ticket_note:$("#ticket-note-template").html(),chat_item:$("#chat-item-template").html(),responder:$("#responder-template").html()},container:{ticket_detail:$("#ticket-detail-portlet .portlet-body"),ticket_note_parent:$("#dispatch-note-parent")},noteType:{ticket_note:1,reporter_note:2,responder_note:3},modal:{ticket_detail:$("#ticket-detail-portlet")},init:function(){var t=this;t.bindHandlers()},bindHandlers:function(){var t=this;t.onLoad(),t.actionEvents(),t.keyEvents()},onLoad:function(){var t=this;$(document).ready(function(){var e=window.location.hash.replace("#","");_.isEmpty(e)||t.getTicketDetails(e)})},actionEvents:function(){var t=this;$(document).on("click","#dispatcher-btn",function(e){t.addDispatcherNote()}),$(document).on("click",".history-child a",function(e){e.preventDefault(),t.detailLastUpdate=0;var o=$(this).attr("href").replace("#","");window.location.hash=o,t.getTicketDetails(o)}),$(document).on("click","#ticket-detail-portlet .tools .tool-close",function(e){e.preventDefault(),window.location.hash="",t.hideModal()}),$(document).on("click",".ticket-status-select li a",function(e){e.preventDefault();var o=$(this).data(),n=t.getStatus(o.val).trim().toLowerCase(),i=$(".status-select a .ticket-status").text().trim().toLowerCase();i!==n&&(t.updateTicketStatus(o.val),t.sendNote('Ticket status updated to "'+n+'"',t.noteType.reporter_note))}),$(document).on("click","#btn-select-responders",function(e){t.getResponders()}),$(document).on("click","button.assign-responder",function(e){var o=$(this).data();t.assignResponder(o.id,$(this))}),$(document).on("click","#modal-select-responder .tools .tool-close, .modal-select-responder-close",function(t){$("#modal-select-responder").hide()}),$(document).on("click","#view-map",function(t){t.preventDefault();var e=$(this).data(),o=e.lat,n=e["long"],i=e.id,r=App.util.modal.init({title:"Map",body:'<div id="dialog-map" class="dialog-map"></div>',width:"600px",footerClose:!1,footerButtons:[{title:"Close",classes:["btn","blue"],callback:function(t){$("#"+t.data.modalId).hide()}}]});r.show();var a=r._options.id,s=$("#"+a+" .modal-dialog .modal-content .modal-body #dialog-map");App.Maps&&App.Maps.loadMap(s,null,function(t){t.getInitLocation(o,n),t.mapLoaded=!0,t.addMarker(o,n,i)})})},getStatus:function(t){var e={open:"Open",enroute:"Enroute",on_site:"On Site",close:"Close"};return e[t]},getCategoryName:function(t){var e={1:"Alert for Fire",2:"Call Ambulance",3:"Report a Crime",4:"Panic",5:"Emergency Button"};return e[t]},setStatus:function(t){var e=this,o=e.getStatus(t);$(".status-select a .ticket-status").text(o)},keyEvents:function(){var t=this;$(document).on("keypress","#inputChatReporter",function(e){13===e.which&&(e.preventDefault(),t.addReporterNote())}),$(document).on("keypress","#inputChatResponder",function(e){13===e.which&&(e.preventDefault(),t.addResponderNote())})},addDispatcherNote:function(){var t=this,e=$("#dispatch-text-input").val(),o=!_.isEmpty(e);o&&(t.sendNote(e,t.noteType.ticket_note),t.sendNote("Update Sent",t.noteType.responder_note),$('.ticket-status-select li a[data-val="open"]').trigger("click"),$("#dispatcher-btn").text("Update"));

},addReporterNote:function(){var t=this,e=$("#inputChatReporter").val(),o=!_.isEmpty(e);o&&t.sendNote(e,t.noteType.reporter_note)},addResponderNote:function(){var t=this,e=$("#inputChatResponder").val(),o=!_.isEmpty(e);o&&t.sendNote(e,t.noteType.responder_note)},sendNote:function(t,e){var o=this,n={ticket_id:o.selectedTicket,notes:t,noteType:e};(o.modalVisible||0!=o.selectedTicket)&&$.ajax({url:"/tickets/update",type:"POST",data:n,success:function(t){"ok"===t.status&&(o.detailLastUpdate=t.next,o.renderTicketDetails(t,e))},error:function(t){}})},showResponderModal:function(){$("#modal-select-responder").show()},assignResponder:function(t,e){var o=this;$parent=e.parent(),e.prop("disabled",!0).find("i").addClass("glyphicon glyphicon-refresh spinning").next().text(""),$.ajax({url:"/tickets/assign-responders",type:"POST",data:{ticket_id:o.selectedTicket,responder_id:t},success:function(t){console.log(t),"ok"===t.status&&(e.remove(),$parent.text("ASSIGNED"),$("#units-selected").find("span").text(t.count_assigned))},error:function(t){}})},getResponders:function(){var t=this;$.ajax({url:"/user/responders",type:"GET",data:{},success:function(e){if("ok"===e.status){var e=t.sortResponders(e.responders);t.showResponderModal(),t.renderResponderUnits(e)}},error:function(t){}})},renderResponderUnits:function(t){var e=this;$("#modal-select-responder").find("tbody").html(""),$.each(t,function(t,o){var n=_.template(e.template.responder)({id:o.id,name:o.name,contact:o.contact_no,distance:App.util.format(o.distance)+"km"});$("#modal-select-responder").find("tbody").append(n)})},sortResponders:function(t){var e=[],o=$("#view-map").data(),n=App.Maps.getLongLat(o.lat,o["long"]);return $.each(t,function(t,o){if(o.profile&&o.profile.lat>0&&o.profile["long"]>0){var i=App.Maps.getLongLat(o.profile.lat,o.profile["long"]),r={id:o.id,name:o.first_name+" "+o.last_name,contact_no:o.profile.mobile_number,lat:o.profile.lat,lng:o.profile["long"],rLatLng:i,distance:App.Maps.computeDistance(n,i)};e.push(r)}}),_.sortBy(e,"distance")},getTicketDetails:function(t){var e=this;App.util.loader.show(),$.ajax({url:"/tickets/"+t+"/updates",type:"GET",data:{},success:function(o){"ok"===o.status&&(e.selectedTicket=t,e.showModal(o),App.util.loader.hide())},error:function(t){App.util.loader.hide()}})},updateTicketStatus:function(t){var e=this;$.ajax({url:"/tickets/update-status",type:"POST",data:{id:e.selectedTicket,status:t},success:function(o){"ok"===o.status&&e.setStatus(t)},error:function(t){}})},fetchNewTicketDetails:function(){var t=this,e=t.selectedTicket;(t.modalVisible||0!=t.selectedTicket)&&$.ajax({url:"/tickets/"+e+"/updates",type:"GET",data:{last:t.detailLastUpdate},success:function(e){"ok"===e.status&&(t.detailLastUpdate=e.next,t.setStatus(e.ticket.status),t.renderDispatcherNotes(e.ticketNotes),t.renderResponderNotes(e.responderNotes),3===window.user.group.id&&t.renderReporterNotes(e.reporterNotes)),t.checkNewTicketDetails()},error:function(e){t.checkNewTicketDetails()}})},checkNewTicketDetails:function(){var t=this;setTimeout(function(){t.fetchNewTicketDetails()},5e3)},showModal:function(t){var e=this,o=_.template(e.template.ticket_detail)({ticket:t.ticket,ticketHistory:t.ticketHistory});$("#ticket-detail-id").html(e.selectedTicket),$("#ticket-detail-header").html("- "+e.getCategoryName(t.ticket.category_id)+" Pressed at "+t.ticket.created_at),4===t.ticket.category_id?$("#ticket-detail-portlet").find(".portlet-title").addClass("bg-blood"):$("#ticket-detail-portlet").find(".portlet-title").removeClass("bg-blood"),e.container.ticket_detail.html(o),e.modal.ticket_detail.show(),e.modalVisible=!0,App.Maps&&App.Maps.loadMap($("#mini-map"),null,function(e){e.getInitLocation(t.ticket.lat,t.ticket["long"]),e.mapLoaded=!0,e.addMarker(t.ticket.lat,t.ticket["long"],t.ticket.id)});var n="new"===t.ticket.status?"Dispatch":"Update";$("#dispatcher-btn").text(n),$("#units-selected").find("span").text(t.count_assigned),e.fetchNewTicketDetails()},hideModal:function(){var t=this;t.modal.ticket_detail.hide(),t.modalVisible=!1,t.lastUpdate=0},renderTicketDetails:function(t,e){var o=this;switch(e){case o.noteType.ticket_note:o.renderDispatcherNotes(t.ticketNotes),$("#dispatch-text-input").val("");break;case o.noteType.reporter_note:o.renderReporterNotes(t.ticketNotes),$("#inputChatReporter").val("");break;case o.noteType.responder_note:o.renderResponderNotes(t.ticketNotes),$("#inputChatResponder").val("")}},renderDispatcherNotes:function(t){var e=this;$.each(t,function(t,o){var n=_.template(e.template.ticket_note)({ticketNote:o});$("#dispatch-note-parent").append(n)}),App.util.scrollBottom("#dispatch-note-parent")},renderReporterNotes:function(t){var e=this;$.each(t,function(t,o){var n=_.template(e.template.chat_item)({user:o.user.first_name+" "+o.user.last_name,user_id:o.user_id,message:o.notes});$("#reporter-chat-container").append(n)}),App.util.scrollBottom("#reporter-chat-container")},renderResponderNotes:function(t){var e=this;$.each(t,function(t,o){var n=_.template(e.template.chat_item)({user:o.user.first_name+" "+o.user.last_name,user_id:o.user_id,message:o.notes});$("#responder-chat-container").append(n)}),App.util.scrollBottom("#responder-chat-container")}},$(function(){App.TicketDetail.init()}),window.App=window.App||{},window.App.Ticket={lastUpdate:0,template:{ticket_entry:$("#ticket-entry-template").html()},container:{ticket_entry:$("#ticket-entry-container")},init:function(){var t=this;t.bindHandlers(),t.ticketTimer(),t.fetchTickets()},bindHandlers:function(){var t=this;t.actionEvent(),t.keyEvent(),t.mouseEvent()},saveSelectedLatLong:function(t,e){console.log("saving coordinates..."),console.log(t),console.log(e)},actionEvent:function(){$(document).on("click","#ticket-entry-container .ticket-entry",function(t){var e=$(this),o=e.data();App.TicketDetail.getTicketDetails(o.id)})},keyEvent:function(){$(document).on("keypress","#email",function(t){13===t.which&&(console.log("email press"),$("#password").focus())}),$(document).on("keypress","#password",function(t){13===t.which&&(console.log("password press"),$("#btnLogin").trigger("click"))})},mouseEvent:function(){$(document).on("mouseover","#ticket-entry-container .ticket-entry",function(t){var e=$(this),o=e.data();App.Maps.bounceMarker(o.id,!0)}),$(document).on("mouseout","#ticket-entry-container .ticket-entry",function(t){var e=$(this),o=e.data();App.Maps.bounceMarker(o.id,!1)})},ticketTimer:function(){var t=this;setInterval(function(){t.updateTicketTime()},1e3)},updateTicketTime:function(){var t=this,e=t.container.ticket_entry.find(".t-time");$.each(e,function(t,e){var o=$(e),n=o.data(),i=App.util.timeAgo(n.time);o.html(i)})},fetchTickets:function(){var t=this;$.ajax({url:"/tickets",type:"GET",data:{last:t.lastUpdate},success:function(e){"ok"===e.status&&(t.renderTickets(e.tickets),t.updateTicketTime(),t.lastUpdate=e.next,e.tickets.length>0&&t.sortTickets()),t.checkNewTicket()},error:function(e){t.checkNewTicket()}})},sortTickets:function(){var t=this;t.container.ticket_entry.find("tr.ticket-entry").sortElements(function(t,e){return $(t).data().timeUtc>$(e).data().timeUtc?-1:1})},renderTickets:function(t){var e=this;$.each(t,function(t,o){var n={1:"bl-fire",2:"bl-med",3:"bl-crime",4:"bl-panic",5:"bl-emergency"},i={1:"i-fire",2:"i-ambulance",3:"i-police",4:"i-alert"},r={ticket_id:o.id,category_id:o.category_id,notes:o.notes,lat:o.lat,lng:o["long"],created_time:o.created_at,created_time_utc:moment(o.created_at).format("X"),status:o.status.split("_").join(" "),brdr_color:n[o.category_id],status_color:"t-status-"+o.status,icon:i[o.category_id]},a=_.template(e.template.ticket_entry)(r);e.container.ticket_entry.append(a),0!==o.lat&&0!==o["long"]&&App.Maps.addMarker(o.lat,o["long"],o.id)})},checkNewTicket:function(){var t=this;setTimeout(function(){t.fetchTickets()},5e3)}},$(function(){App.Ticket.init()}),App.util={format:function(t){return t.toFixed(2).replace(/./g,function(t,e,o){return e>0&&"."!==t&&(o.length-e)%3===0?","+t:t})},timeAgo:function(t){var e=moment(t),o=moment().diff(e,"seconds");return 60>o?o+"s":(o=moment().diff(e,"minutes"),60>o?o+"m":(o=moment().diff(e,"hours"),24>o?o+"h":(o=moment().diff(e,"days"),7>o?o+"d":(o=moment().diff(e,"weeks"),4>o?o+"w":(o=moment().diff(e,"months"),o+"mo")))))},loader:{show:function(){$.LoadingOverlay("show")},hide:function(){$.LoadingOverlay("hide")}},scroll:function(t,e){_.isUndefined(t)?$(e).animate({scrollTop:0},"fast"):$(e).animate({scrollTop:$(e)[0].scrollHeight},"fast")},scrollTop:function(t){var e=this;e.scroll(t)},scrollBottom:function(t){var e=this;e.scroll("bottom",t)},modal:{_modalNumber:0,_options:{id:"",headerClose:!0,title:"Modal Title",body:"Modal Body",footerClose:!0,keyboard:!1,backdrop:"static",width:!1,footerButtons:[],callback:function(){}},_html:"",init:function(t){return $.extend(!0,{},App.util.modal)._init(t)},_init:function(t){return this._options=$.extend(this._options,t),this._generateId(),this._generateModalHTML(),this},show:function(){this._html.modal().show()},remove:function(){$("#"+this._options.id).remove()},_generateId:function(){var t=_.uniqueId("e117-modal-");this._options.id=""===this._options.id?_.uniqueId("e117-modal-"):this._options.id,this._modalNumber=t.split("-")[2]},_generateModalHTML:function(){this._html=$("<div/>").addClass("modal fade").attr("id",this._options.id).attr("tabindex",this._modalNumber).attr("role","dialog").attr("aria-hidden","true").attr("data-backdrop","static").attr("data-keyboard","false");var t=$("<div/>").addClass("modal-dialog");this._options.width&&t.css({width:this._options.width}),t.appendTo(this._html);var e=$("<div/>").addClass("modal-content");e.appendTo(t);var o=$("<div/>").addClass("modal-header");o.appendTo(e),this._options.headerClose&&$("<button/>").addClass("close").attr("type","button").attr("data-dismiss","modal").attr("aria-hidden","true").appendTo(o),$("<h4/>").addClass("modal-title").text(this._options.title).appendTo(o),$("<div/>").addClass("modal-body").html(this._options.body).appendTo(e);var n=$("<div/>").addClass("modal-footer");n.appendTo(e),this._options.footerClose&&$("<button/>").addClass("btn default").attr("type","button").attr("data-dismiss","modal").text("Close").appendTo(n);for(var i in this._options.footerButtons)if("object"==typeof this._options.footerButtons[i]){var r=this._options.footerButtons[i].classes?this._options.footerButtons[i].classes.join(" "):"";$("<button/>").addClass(r).text(this._options.footerButtons[i].title).on("click",null,{modalId:this._options.id},this._options.footerButtons[i].callback).appendTo(n)}""===n.html()&&n.addClass("hide"),$("body").append(this._html),"function"==typeof this._options.callback&&this._options.callback()}}};